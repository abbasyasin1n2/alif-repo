
{% extends "base.html" %}

{% block title %}View Processing Session{% endblock %}

{% block content %}
<h2 class="header">Session: {{ session.session_name }}</h2>
<p><strong>Date:</strong> {{ session.session_date }}</p>
<p><strong>Notes:</strong> {{ session.notes }}</p>

<div class="row">
    <div class="col s12">
        <div class="card">
            <div class="card-content">
                <span class="card-title">Yield Analysis</span>
                <div class="row">
                    <div class="col s4">
                        <h5 class="center-align">Total Input</h5>
                        <p class="center-align flow-text">{{ "%.2f"|format(total_input_weight) }} kg</p>
                    </div>
                    <div class="col s4">
                        <h5 class="center-align">Total Output</h5>
                        <p class="center-align flow-text">{{ "%.2f"|format(total_output_weight) }} kg</p>
                    </div>
                    <div class="col s4">
                        <h5 class="center-align">Yield Percentage</h5>
                        <p class="center-align flow-text">{{ "%.2f"|format(yield_percentage) }}%</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col s6">
        <h3 class="header">Inputs</h3>
        <a href="{{ url_for('processing.add_input', id=session.id) }}" class="btn-floating waves-effect waves-light right">
            <i class="material-icons">add</i>
        </a>
        <table class="striped">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Batch Number</th>
                    <th>Quantity Used (kg)</th>
                </tr>
            </thead>
            <tbody>
                {% for input in inputs %}
                <tr>
                    <td>{{ input.product_name }}</td>
                    <td>{{ input.batch_number }}</td>
                    <td>{{ "%.2f"|format(input.quantity_used) }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="3" class="center-align">No inputs found for this session.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="col s6">
        <h3 class="header">Outputs</h3>
        <a href="{{ url_for('processing.add_output', id=session.id) }}" class="btn-floating waves-effect waves-light right {% if not inputs %}disabled{% endif %}">
            <i class="material-icons">add</i>
        </a>
        <table class="striped">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Output Type</th>
                    <th>Weight (kg)</th>
                </tr>
            </thead>
            <tbody>
                {% for output in outputs %}
                <tr>
                    <td>{{ output.product_name }}</td>
                    <td>{{ output.output_type }}</td>
                    <td>{{ "%.2f"|format(output.weight) }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="3" class="center-align">No outputs found for this session.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="fixed-action-btn">
    <a href="{{ url_for('processing.list_sessions') }}" class="btn-floating btn-large grey">
        <i class="large material-icons">arrow_back</i>
    </a>
</div>
{% endblock %}
